# ミューテーション、クエリ、そしてサブスクリプションを整理する

<https://relay.dev/docs/tutorial/organizing-mutations-queries-and-subscriptions/>

- [ミューテーション、クエリ、そしてサブスクリプションを整理する](#ミューテーションクエリそしてサブスクリプションを整理する)
  - [ミューテーションとサブスクリプションの推奨される構造](#ミューテーションとサブスクリプションの推奨される構造)
  - [クエリの推奨される構造](#クエリの推奨される構造)

ミューテーション、クエリそしてサブスクリプションのRelayの操作は、厳密な名前付けの要求があります。
操作名はモジュール名で始まり、最後はGraphQLの操作の種類で終わらなければなりません。
また、名前はグローバルで一意でなければなりません。

> メモ書き: この名前付けの組み合わせは、一意制約を強制する試みから始まりました。
> メタでは、静的なリソースの依存管理システムであるHasteが、意味のあるグローバルで一意なRelayの名前を導出するために、すべてのモジュールの名前を一意にすることを強制しています。
> また、モジュール名とRelayの名前を組み合わせることは、名前を知っていればフラグメント、クエリ、ミューテーションを配置することを容易にします。
> これはメタでは理にかなっており、OSSの設定において意味が少ないかもしれません。

例えば・・・

1. `MyComponent.js`ファイル内のミューテーションは、`MyComponent[MyDescriptiveNameHere]Mutation`の組み合わせで名付けられなければ成りません。
2. `MyComponent.react.js`ファイル内のクエリは、`MyComponent*Query`のスキームで名付けられなければなりません。

`NewsFeed`コンポーネントは、論理的に`NewsFeed`で始まるべきでないミューテーションとクエリがあるかもしれませんが、*そのファイルにそれらが定義されている場合*、Relayはこれを要求します。

## ミューテーションとサブスクリプションの推奨される構造

ミューテーションをそれら独自のフックモジュールに置くと、名前が*どのコンポーネントがそれを呼び出すのか*よりも、*ミューテーションが何をするのか*に似てきます。
もし、モジュール名が正確に説明的であれば、同じ名前にそれを宣言することは良いことです。

`Post`用のミューテーションを追加している場合、投稿にコメントを追加することと同じように、`useAddPostComment.js`と付けられた新しいファイルに作成するかもしれません。
そして、このファイル内のミューテーションは、`useAddPostCommentMutation`と名付けられ、それは完全に説明的な名前です。

専用の`hooks`ディレクトリにこれらのフックすべてを置くことを検討するかもしれません。

## クエリの推奨される構造

ルートコンポーネントは、コンポーネントに強く組み合わされた1つのクエリを持つべきで、それはコンポーネントのデータの依存を説明します。
クエリとフラグメントは、それらのデータを使用するコードと一緒に同じ場所に配置されるべきです。
